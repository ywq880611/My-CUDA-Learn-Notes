# Elementwise Add

This folder consists some kernels to process embedding op.

## command
```
python elementwise.py
```

## output on RTX3080
```
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=2048, EmbSize=512
                out_f32: ['-0.29139331 ', '-0.43377501 ', '-0.35815737 '], time:0.011098ms
              out_f32x4: ['-0.29139331 ', '-0.43377501 ', '-0.35815737 '], time:0.013387ms
         out_f32x4_pack: ['-0.29139331 ', '-0.43377501 ', '-0.35815737 '], time:0.009096ms
             out_f32_th: ['-0.29139331 ', '-0.43377501 ', '-0.35815737 '], time:0.015795ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.140625   ', '0.4074707   ', '-1.2578125  '], time:0.006402ms
              out_f16x8: ['-0.140625   ', '0.4074707   ', '-1.2578125  '], time:0.013280ms
         out_f16x8_pack: ['-0.140625   ', '0.4074707   ', '-1.2578125  '], time:0.003505ms
             out_f16_th: ['-0.140625   ', '0.4074707   ', '-1.2578125  '], time:0.029933ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=2048, EmbSize=1024
                out_f32: ['-1.04920268 ', '1.12509632  ', '-1.06921613 '], time:0.028372ms
              out_f32x4: ['-1.04920268 ', '1.12509632  ', '-1.06921613 '], time:0.024664ms
         out_f32x4_pack: ['-1.04920268 ', '1.12509632  ', '-1.06921613 '], time:0.021756ms
             out_f32_th: ['-1.04920268 ', '1.12509632  ', '-1.06921613 '], time:0.034142ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.83154297 ', '1.13183594  ', '0.28588867  '], time:0.021434ms
              out_f16x8: ['-0.83154297 ', '1.13183594  ', '0.28588867  '], time:0.024474ms
         out_f16x8_pack: ['-0.83154297 ', '1.13183594  ', '0.28588867  '], time:0.008941ms
             out_f16_th: ['-0.83154297 ', '1.13183594  ', '0.28588867  '], time:0.027072ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=4096, EmbSize=512
                out_f32: ['-0.72741318 ', '1.38453054  ', '0.07262569  '], time:0.020003ms
              out_f32x4: ['-0.72741318 ', '1.38453054  ', '0.07262569  '], time:0.024474ms
         out_f32x4_pack: ['-0.72741318 ', '1.38453054  ', '0.07262569  '], time:0.018084ms
             out_f32_th: ['-0.72741318 ', '1.38453054  ', '0.07262569  '], time:0.027919ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['1.68554688  ', '-1.09277344 ', '-0.02908325 '], time:0.014615ms
              out_f16x8: ['1.68554688  ', '-1.09277344 ', '-0.02908325 '], time:0.024652ms
         out_f16x8_pack: ['1.68554688  ', '-1.09277344 ', '-0.02908325 '], time:0.014973ms
             out_f16_th: ['1.68554688  ', '-1.09277344 ', '-0.02908325 '], time:0.026643ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=4096, EmbSize=1024
                out_f32: ['1.3580358   ', '-1.12297678 ', '0.53372478  '], time:0.053513ms
              out_f32x4: ['1.3580358   ', '-1.12297678 ', '0.53372478  '], time:0.047028ms
         out_f32x4_pack: ['1.3580358   ', '-1.12297678 ', '0.53372478  '], time:0.041223ms
             out_f32_th: ['1.3580358   ', '-1.12297678 ', '0.53372478  '], time:0.056756ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-1.92285156 ', '0.37768555  ', '-2.25976562 '], time:0.041306ms
              out_f16x8: ['-1.92285156 ', '0.37768555  ', '-2.25976562 '], time:0.057721ms
         out_f16x8_pack: ['-1.92285156 ', '0.37768555  ', '-2.25976562 '], time:0.018191ms
             out_f16_th: ['-1.92285156 ', '0.37768555  ', '-2.25976562 '], time:0.050533ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=2048, EmbSize=512
                out_f32: ['0.39992279  ', '0.57187545  ', '-0.02278765 '], time:0.014269ms
              out_f32x4: ['0.39992279  ', '0.57187545  ', '-0.02278765 '], time:0.014329ms
         out_f32x4_pack: ['0.39992279  ', '0.57187545  ', '-0.02278765 '], time:0.013137ms
             out_f32_th: ['0.39992279  ', '0.57187545  ', '-0.02278765 '], time:0.017178ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.35595703 ', '-0.48608398 ', '-0.75097656 '], time:0.006354ms
              out_f16x8: ['-0.35595703 ', '-0.48608398 ', '-0.75097656 '], time:0.013161ms
         out_f16x8_pack: ['-0.35595703 ', '-0.48608398 ', '-0.75097656 '], time:0.003433ms
             out_f16_th: ['-0.35595703 ', '-0.48608398 ', '-0.75097656 '], time:0.014198ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=2048, EmbSize=1024
                out_f32: ['-0.22729582 ', '-0.16355558 ', '0.63510412  '], time:0.040030ms
              out_f32x4: ['-0.22729582 ', '-0.16355558 ', '0.63510412  '], time:0.026381ms
         out_f32x4_pack: ['-0.22729582 ', '-0.16355558 ', '0.63510412  '], time:0.025678ms
             out_f32_th: ['-0.22729582 ', '-0.16355558 ', '0.63510412  '], time:0.031078ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.40625    ', '-2.4140625  ', '0.42675781  '], time:0.025713ms
              out_f16x8: ['-0.40625    ', '-2.4140625  ', '0.42675781  '], time:0.025368ms
         out_f16x8_pack: ['-0.40625    ', '-2.4140625  ', '0.42675781  '], time:0.012827ms
             out_f16_th: ['-0.40625    ', '-2.4140625  ', '0.42675781  '], time:0.027657ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=4096, EmbSize=512
                out_f32: ['0.18506987  ', '-2.25141215 ', '0.13029745  '], time:0.026250ms
              out_f32x4: ['0.18506987  ', '-2.25141215 ', '0.13029745  '], time:0.025058ms
         out_f32x4_pack: ['0.18506987  ', '-2.25141215 ', '0.13029745  '], time:0.024581ms
             out_f32_th: ['0.18506987  ', '-2.25141215 ', '0.13029745  '], time:0.030744ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['0.24865723  ', '-1.18164062 ', '1.76074219  '], time:0.017452ms
              out_f16x8: ['0.24865723  ', '-1.18164062 ', '1.76074219  '], time:0.024629ms
         out_f16x8_pack: ['0.24865723  ', '-1.18164062 ', '1.76074219  '], time:0.011826ms
             out_f16_th: ['0.24865723  ', '-1.18164062 ', '1.76074219  '], time:0.027454ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=4096, EmbSize=1024
                out_f32: ['1.03668284  ', '-1.40364337 ', '-0.63255215 '], time:0.061274ms
              out_f32x4: ['1.03668284  ', '-1.40364337 ', '-0.63255215 '], time:0.048828ms
         out_f32x4_pack: ['1.03668284  ', '-1.40364337 ', '-0.63255215 '], time:0.049901ms
             out_f32_th: ['1.03668284  ', '-1.40364337 ', '-0.63255215 '], time:0.060892ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.78857422 ', '0.18884277  ', '0.05917358  '], time:0.048363ms
              out_f16x8: ['-0.78857422 ', '0.18884277  ', '0.05917358  '], time:0.047219ms
         out_f16x8_pack: ['-0.78857422 ', '0.18884277  ', '0.05917358  '], time:0.024331ms
             out_f16_th: ['-0.78857422 ', '0.18884277  ', '0.05917358  '], time:0.052083ms
--------------------------------------------------------------------------------------------------------------
```